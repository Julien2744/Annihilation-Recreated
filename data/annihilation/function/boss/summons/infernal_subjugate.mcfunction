execute if score #anniR.global anniR.difficulty matches 0 run summon slime ~ ~ ~ {NoGravity:1b,Silent:1b,Invulnerable:1b,DeathLootTable:"minecraft:empty",PersistenceRequired:1b,NoAI:1b,CanPickUpLoot:0b,Tags:["anniR.immune","anniR.summoned"],Passengers:[{id:"minecraft:enderman",Silent:0b,Invulnerable:0b,Glowing:1b,DeathLootTable:"minecraft:empty",PersistenceRequired:1b,NoAI:1b,CanPickUpLoot:0b,Health:90f,Tags:["anniR.immune","anniR.summoned"],Passengers:[{id:"minecraft:end_crystal",HasVisualFire:0b,Invulnerable:1b,Glowing:1b,ShowBottom:0b,Tags:["anniR.immune","anniR.summoned","anniR.regen"],beam_target:[I;0,0,0]}],active_effects:[{id:"minecraft:fire_resistance",amplifier:1,duration:-1,show_particles:0b,ambient:0b}],attributes:[{id:"minecraft:generic.max_health",base:90}]}],active_effects:[{id:"minecraft:invisibility",amplifier:1,duration:-1,show_particles:0b,ambient:0b}]}
execute if score #anniR.global anniR.difficulty matches 1 run summon slime ~ ~ ~ {NoGravity:1b,Silent:1b,Invulnerable:1b,DeathLootTable:"minecraft:empty",PersistenceRequired:1b,NoAI:1b,CanPickUpLoot:0b,Tags:["anniR.immune","anniR.summoned"],Passengers:[{id:"minecraft:enderman",Silent:0b,Invulnerable:0b,Glowing:1b,DeathLootTable:"minecraft:empty",PersistenceRequired:1b,NoAI:1b,CanPickUpLoot:0b,Health:120f,Tags:["anniR.immune","anniR.summoned"],Passengers:[{id:"minecraft:end_crystal",HasVisualFire:0b,Invulnerable:1b,Glowing:1b,ShowBottom:0b,Tags:["anniR.immune","anniR.summoned","anniR.regen"],beam_target:[I;0,0,0]}],active_effects:[{id:"minecraft:fire_resistance",amplifier:1,duration:-1,show_particles:0b,ambient:0b}],attributes:[{id:"minecraft:generic.max_health",base:120}]}],active_effects:[{id:"minecraft:invisibility",amplifier:1,duration:-1,show_particles:0b,ambient:0b}]}
execute if score #anniR.global anniR.difficulty matches 2 run summon slime ~ ~ ~ {NoGravity:1b,Silent:1b,Invulnerable:1b,DeathLootTable:"minecraft:empty",PersistenceRequired:1b,NoAI:1b,CanPickUpLoot:0b,Tags:["anniR.immune","anniR.summoned"],Passengers:[{id:"minecraft:enderman",Silent:0b,Invulnerable:0b,Glowing:1b,DeathLootTable:"minecraft:empty",PersistenceRequired:1b,NoAI:1b,CanPickUpLoot:0b,Health:180f,Tags:["anniR.immune","anniR.summoned"],Passengers:[{id:"minecraft:end_crystal",HasVisualFire:0b,Invulnerable:1b,Glowing:1b,ShowBottom:0b,Tags:["anniR.immune","anniR.summoned","anniR.regen"],beam_target:[I;0,0,0]}],active_effects:[{id:"minecraft:fire_resistance",amplifier:1,duration:-1,show_particles:0b,ambient:0b}],attributes:[{id:"minecraft:generic.max_health",base:180}]}],active_effects:[{id:"minecraft:invisibility",amplifier:1,duration:-1,show_particles:0b,ambient:0b}]}

execute as @n[type=end_crystal,distance=..3,tag=anniR.immune,tag=anniR.regen] store result entity @s beam_target[0] double 1 run data get entity @e[type=item_display,tag=aj.annihilation_recreated.root,distance=..90,limit=1] Pos[0]
execute as @n[type=end_crystal,distance=..3,tag=anniR.immune,tag=anniR.regen] store result entity @s beam_target[1] double 1 run data get entity @e[type=item_display,tag=aj.annihilation_recreated.root,distance=..90,limit=1] Pos[1]
execute as @n[type=end_crystal,distance=..3,tag=anniR.immune,tag=anniR.regen] store result entity @s beam_target[2] double 1 run data get entity @e[type=item_display,tag=aj.annihilation_recreated.root,distance=..90,limit=1] Pos[2]

execute store result score #anniR.global anniR.checkMobGrief run gamerule mobGriefing
execute if score #anniR.global anniR.checkMobGrief matches 1 run fill ~-1 ~-1 ~-1 ~1 ~-1 ~1 minecraft:netherrack destroy
execute if score #anniR.global anniR.checkMobGrief matches 1 run fill ~-1 ~3 ~-1 ~1 ~ ~1 minecraft:air destroy

execute if score #anniR.global anniR.team matches 1 run team join annihilation_team @n[type=slime,tag=anniR.immune,tag=anniR.summoned,distance=..1]
execute if score #anniR.global anniR.team matches 1 run team join annihilation_team @n[type=enderman,tag=anniR.immune,tag=anniR.summoned,distance=..2]
execute if score #anniR.global anniR.team matches 1 run team join annihilation_team @n[type=end_crystal,tag=anniR.immune,distance=..3]